# Axum Web Application

ä¸€ä¸ªä½¿ç”¨ Rust å’Œ Axum æ¡†æ¶æ„å»ºçš„ç°ä»£åŒ– Web åº”ç”¨ç¨‹åºï¼Œæ¼”ç¤ºäº†å®Œæ•´çš„ REST API å¼€å‘å®è·µã€‚

## ğŸš€ åŠŸèƒ½ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½
- âœ… **ç”¨æˆ·è®¤è¯**: JWT ä»¤ç‰Œè®¤è¯ç³»ç»Ÿ
- âœ… **CRUD æ“ä½œ**: å®Œæ•´çš„ç”¨æˆ·å’Œå¸–å­ç®¡ç†
- âœ… **æ•°æ®åº“é›†æˆ**: PostgreSQL æ•°æ®åº“æ”¯æŒ
- âœ… **é”™è¯¯å¤„ç†**: ç»Ÿä¸€çš„é”™è¯¯å¤„ç†æœºåˆ¶
- âœ… **æ—¥å¿—è®°å½•**: ç»“æ„åŒ–æ—¥å¿—è¾“å‡º
- âœ… **API æ–‡æ¡£**: å†…ç½®å¥åº·æ£€æŸ¥å’ŒçŠ¶æ€ç›‘æ§

### æŠ€æœ¯ç‰¹æ€§
- ğŸ¦€ **ç°ä»£ Rust**: ä½¿ç”¨æœ€æ–°çš„ Rust ç‰¹æ€§å’Œæœ€ä½³å®è·µ
- âš¡ **é«˜æ€§èƒ½**: åŸºäº Axum çš„å¼‚æ­¥ Web æ¡†æ¶
- ğŸ”’ **å®‰å…¨æ€§**: å¯†ç å“ˆå¸Œã€JWT è®¤è¯ã€è¾“å…¥éªŒè¯
- ğŸ—„ï¸ **æ•°æ®åº“**: PostgreSQL + SQLx ORM
- ğŸ“ **éªŒè¯**: æ•°æ®éªŒè¯å’Œé”™è¯¯å¤„ç†
- ğŸŒ **CORS**: è·¨åŸŸèµ„æºå…±äº«æ”¯æŒ

## ğŸ“‹ API ç«¯ç‚¹

### è®¤è¯ç›¸å…³
```
POST /api/auth/register  # ç”¨æˆ·æ³¨å†Œ
POST /api/auth/login     # ç”¨æˆ·ç™»å½•
```

### ç”¨æˆ·ç®¡ç†
```
GET    /api/users/me           # è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
PUT    /api/users/me           # æ›´æ–°å½“å‰ç”¨æˆ·ä¿¡æ¯
DELETE /api/users/me           # åˆ é™¤å½“å‰ç”¨æˆ·è´¦æˆ·
GET    /api/users/:id          # è·å–æŒ‡å®šç”¨æˆ·ä¿¡æ¯ (ç®¡ç†å‘˜)
PUT    /api/users/:id          # æ›´æ–°æŒ‡å®šç”¨æˆ·ä¿¡æ¯ (ç®¡ç†å‘˜)
DELETE /api/users/:id          # åˆ é™¤æŒ‡å®šç”¨æˆ· (ç®¡ç†å‘˜)
```

### å¸–å­ç®¡ç†
```
GET    /api/posts              # è·å–æ‰€æœ‰å¸–å­ (åˆ†é¡µ)
POST   /api/posts              # åˆ›å»ºæ–°å¸–å­ (éœ€è®¤è¯)
GET    /api/posts/:id          # è·å–æŒ‡å®šå¸–å­
PUT    /api/posts/:id          # æ›´æ–°å¸–å­ (éœ€è®¤è¯ + æƒé™)
DELETE /api/posts/:id          # åˆ é™¤å¸–å­ (éœ€è®¤è¯ + æƒé™)
GET    /api/posts/search       # æœç´¢å¸–å­
GET    /api/users/me/posts     # è·å–å½“å‰ç”¨æˆ·çš„å¸–å­
GET    /api/users/:id/posts    # è·å–æŒ‡å®šç”¨æˆ·çš„å¸–å­
```

### ç³»ç»Ÿç›‘æ§
```
GET /health    # å¥åº·æ£€æŸ¥
GET /ready     # å°±ç»ªæ£€æŸ¥
GET /live      # å­˜æ´»æ£€æŸ¥
```

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### åç«¯æ¡†æ¶
- **Axum 0.7**: ç°ä»£åŒ–çš„å¼‚æ­¥ Web æ¡†æ¶
- **Tokio**: å¼‚æ­¥è¿è¡Œæ—¶
- **Tower**: ä¸­é—´ä»¶å’ŒæœåŠ¡æŠ½è±¡

### æ•°æ®å±‚
- **PostgreSQL**: ä¸»æ•°æ®åº“
- **SQLx**: å¼‚æ­¥ SQL å·¥å…·åŒ…
- **æ•°æ®åº“è¿ç§»**: è‡ªåŠ¨åŒ–æ•°æ®åº“æ¨¡å¼ç®¡ç†

### è®¤è¯å’Œå®‰å…¨
- **JWT**: JSON Web Token è®¤è¯
- **bcrypt**: å¯†ç å“ˆå¸Œ
- **è¾“å…¥éªŒè¯**: è¯·æ±‚æ•°æ®éªŒè¯

### å¼€å‘å·¥å…·
- **tracing**: ç»“æ„åŒ–æ—¥å¿—
- **serde**: åºåˆ—åŒ–/ååºåˆ—åŒ–
- **validator**: æ•°æ®éªŒè¯
- **uuid**: å”¯ä¸€æ ‡è¯†ç¬¦ç”Ÿæˆ

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Rust 1.70+
- PostgreSQL 12+
- ç¯å¢ƒå˜é‡é…ç½®

### å®‰è£…å’Œé…ç½®

1. **å…‹éš†é¡¹ç›®**
```bash
cd examples/stage5-projects/01-axum-web-app
```

2. **é…ç½®ç¯å¢ƒå˜é‡**
```bash
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œé…ç½®æ•°æ®åº“è¿æ¥ç­‰ä¿¡æ¯
```

3. **è®¾ç½®æ•°æ®åº“**
```bash
# åˆ›å»ºæ•°æ®åº“
createdb rust_web_app

# åº”ç”¨ä¼šè‡ªåŠ¨è¿è¡Œè¿ç§»
```

4. **è¿è¡Œåº”ç”¨**
```bash
cargo run
```

åº”ç”¨å°†åœ¨ `http://127.0.0.1:3001` å¯åŠ¨ã€‚

### ä½¿ç”¨ Docker (å¯é€‰)

```bash
# ä½¿ç”¨ Docker Compose å¯åŠ¨å®Œæ•´ç¯å¢ƒ
docker-compose up -d
```

## ğŸ“– API ä½¿ç”¨ç¤ºä¾‹

### ç”¨æˆ·æ³¨å†Œ
```bash
curl -X POST http://127.0.0.1:3001/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "username": "testuser",
    "email": "test@example.com",
    "password": "password123"
  }'
```

### ç”¨æˆ·ç™»å½•
```bash
curl -X POST http://127.0.0.1:3001/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "username": "testuser",
    "password": "password123"
  }'
```

### åˆ›å»ºå¸–å­
```bash
curl -X POST http://127.0.0.1:3001/api/posts \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN" \
  -d '{
    "title": "æˆ‘çš„ç¬¬ä¸€ç¯‡å¸–å­",
    "content": "è¿™æ˜¯å¸–å­çš„å†…å®¹..."
  }'
```

### è·å–å¸–å­åˆ—è¡¨
```bash
curl http://127.0.0.1:3001/api/posts?limit=10&offset=0
```

## ğŸ§ª æµ‹è¯•

### è¿è¡Œæ‰€æœ‰æµ‹è¯•
```bash
cargo test
```

### è¿è¡Œç‰¹å®šæµ‹è¯•
```bash
cargo test test_health_check
cargo test test_jwt_generation_and_validation
```

### ä»£ç è´¨é‡æ£€æŸ¥
```bash
cargo fmt           # æ ¼å¼åŒ–ä»£ç 
cargo clippy        # ä»£ç æ£€æŸ¥
cargo audit         # å®‰å…¨å®¡è®¡
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ main.rs              # åº”ç”¨ç¨‹åºå…¥å£
â”œâ”€â”€ config/              # é…ç½®ç®¡ç†
â”œâ”€â”€ models/              # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ user.rs         # ç”¨æˆ·æ¨¡å‹
â”‚   â””â”€â”€ post.rs         # å¸–å­æ¨¡å‹
â”œâ”€â”€ auth/               # è®¤è¯æ¨¡å—
â”‚   â”œâ”€â”€ jwt.rs          # JWT å·¥å…·
â”‚   â””â”€â”€ middleware.rs   # è®¤è¯ä¸­é—´ä»¶
â”œâ”€â”€ database/           # æ•°æ®åº“æ¨¡å—
â”œâ”€â”€ services/           # ä¸šåŠ¡é€»è¾‘å±‚
â”‚   â”œâ”€â”€ user_service.rs # ç”¨æˆ·æœåŠ¡
â”‚   â””â”€â”€ post_service.rs # å¸–å­æœåŠ¡
â”œâ”€â”€ handlers/           # HTTP å¤„ç†å™¨
â”‚   â”œâ”€â”€ user_handlers.rs
â”‚   â”œâ”€â”€ post_handlers.rs
â”‚   â””â”€â”€ health_handlers.rs
â””â”€â”€ error.rs            # é”™è¯¯å¤„ç†

migrations/             # æ•°æ®åº“è¿ç§»
â”œâ”€â”€ 001_create_users_table.sql
â””â”€â”€ 002_create_posts_table.sql
```

## ğŸ”§ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡

| å˜é‡å | æè¿° | é»˜è®¤å€¼ |
|--------|------|--------|
| `DATABASE_URL` | PostgreSQL è¿æ¥å­—ç¬¦ä¸² | å¿…éœ€ |
| `JWT_SECRET` | JWT ç­¾åå¯†é’¥ | å¿…éœ€ |
| `JWT_EXPIRES_IN` | JWT è¿‡æœŸæ—¶é—´ | `24h` |
| `HOST` | æœåŠ¡å™¨åœ°å€ | `127.0.0.1` |
| `PORT` | æœåŠ¡å™¨ç«¯å£ | `3001` |
| `LOG_LEVEL` | æ—¥å¿—çº§åˆ« | `info` |

### æ•°æ®åº“é…ç½®

åº”ç”¨ä½¿ç”¨ PostgreSQL ä½œä¸ºä¸»æ•°æ®åº“ï¼Œæ”¯æŒï¼š
- è‡ªåŠ¨è¿ç§»
- è¿æ¥æ± 
- äº‹åŠ¡ç®¡ç†
- ä¼˜åŒ–æŸ¥è¯¢

## ğŸ”’ å®‰å…¨ç‰¹æ€§

- **å¯†ç å®‰å…¨**: ä½¿ç”¨ bcrypt è¿›è¡Œå¯†ç å“ˆå¸Œ
- **JWT è®¤è¯**: åŸºäºä»¤ç‰Œçš„èº«ä»½éªŒè¯
- **è¾“å…¥éªŒè¯**: æ‰€æœ‰ç”¨æˆ·è¾“å…¥éƒ½ç»è¿‡éªŒè¯
- **SQL æ³¨å…¥é˜²æŠ¤**: ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢
- **CORS é…ç½®**: å¯é…ç½®çš„è·¨åŸŸè®¿é—®æ§åˆ¶

## ğŸ“Š æ€§èƒ½ç‰¹æ€§

- **å¼‚æ­¥å¤„ç†**: åŸºäº Tokio çš„å…¨å¼‚æ­¥æ¶æ„
- **è¿æ¥æ± **: æ•°æ®åº“è¿æ¥æ± ç®¡ç†
- **ä¸­é—´ä»¶**: è¯·æ±‚æ—¥å¿—ã€CORSã€é”™è¯¯å¤„ç†
- **å¥åº·æ£€æŸ¥**: å†…ç½®çš„å¥åº·ç›‘æ§ç«¯ç‚¹

## ğŸš€ éƒ¨ç½²æŒ‡å—

### ç”Ÿäº§ç¯å¢ƒé…ç½®

1. **è®¾ç½®å¼ºå¯†ç çš„ JWT å¯†é’¥**
2. **é…ç½®ç”Ÿäº§æ•°æ®åº“**
3. **è®¾ç½®åå‘ä»£ç† (Nginx)**
4. **å¯ç”¨ HTTPS**
5. **é…ç½®æ—¥å¿—æ”¶é›†**

### ç¯å¢ƒå˜é‡å®‰å…¨

```bash
# ç”Ÿäº§ç¯å¢ƒç¤ºä¾‹
export DATABASE_URL="postgresql://user:secure_password@prod-db:5432/rust_web_app"
export JWT_SECRET="your-super-secure-256-bit-secret-key"
export LOG_LEVEL="warn"
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/amazing-feature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add amazing feature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/amazing-feature`)
5. åˆ›å»º Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - è¯¦è§ [LICENSE](../../../../../LICENSE) æ–‡ä»¶ã€‚

## ğŸ†˜ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

**Q: æ•°æ®åº“è¿æ¥å¤±è´¥**
A: æ£€æŸ¥ `DATABASE_URL` é…ç½®å’Œæ•°æ®åº“æœåŠ¡çŠ¶æ€

**Q: JWT ä»¤ç‰Œæ— æ•ˆ**
A: æ£€æŸ¥ `JWT_SECRET` é…ç½®å’Œä»¤ç‰Œæ ¼å¼

**Q: è¯·æ±‚è¢« CORS æ‹¦æˆª**
A: æ£€æŸ¥ `CORS_ORIGINS` é…ç½®

### è°ƒè¯•æŠ€å·§

1. è®¾ç½® `LOG_LEVEL=debug` è·å–è¯¦ç»†æ—¥å¿—
2. ä½¿ç”¨ `curl` æˆ– Postman æµ‹è¯• API
3. æ£€æŸ¥æ•°æ®åº“è¿ç§»çŠ¶æ€
4. éªŒè¯ç¯å¢ƒå˜é‡é…ç½®

---

**å¼€å‘å›¢é˜Ÿ**: Rust Learning Project
**æœ€åæ›´æ–°**: 2025-11-15
**ç‰ˆæœ¬**: 0.1.0
